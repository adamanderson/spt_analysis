---
jupyter:
  jupytext:
    text_representation:
      extension: .md
      format_name: markdown
      format_version: '1.0'
      jupytext_version: 0.8.6
  kernelspec:
    display_name: Python 3 (v2)
    language: python
    name: python3-v2
---

# Healpy Tests
We would like to make plots of Planck dust maps for showing the SPT-3G field. Sasha claims that healpy has a straightforward interface for doing this. Let's try this out here.

```python
from healpy import fitsfunc, visufunc
import numpy as np
import matplotlib.pyplot as plt
```

```python
dust_map = fitsfunc.read_map('COM_CompMap_dust-commander_0256_R2.00.fits')
```

```python
# SPT-3G survey
ra_3g         = np.hstack([np.linspace(-50, 50, 1000), np.linspace(50, 50, 1000),
                           np.linspace(50, -50, 1000), np.linspace(-50, -50, 1000)])
dec_3g        = np.hstack([np.linspace(-42, -42, 1000), np.linspace(-42, -70, 1000),
                           np.linspace(-70, -70, 1000), np.linspace(-70, -42, 1000)])

# SPTpol survey (see p3 https://arxiv.org/pdf/1707.09353.pdf)
ra_sptpol     = np.hstack([np.linspace(-360*2/24, 360*2/24, 1000), np.linspace(360*2/24, 360*2/24, 1000),
                           np.linspace(360*2/24, -360*2/24, 1000), np.linspace(-360*2/24, -360*2/24, 1000)])
dec_sptpol    = np.hstack([np.linspace(-50, -50, 1000), np.linspace(-50, -65, 1000),
                           np.linspace(-65, -65, 1000), np.linspace(-65, -50, 1000)])

# SPT-SZ survey (see p3 https://arxiv.org/pdf/1704.00884.pdf)
ra_sptsz      = np.hstack([np.linspace(-360*4/24, 360*7/24, 1000), np.linspace(360*7/24, 360*7/24, 1000),
                           np.linspace(360*7/24, -360*4/24, 1000), np.linspace(-360*4/24, -360*4/24, 1000)])
dec_sptsz     = np.hstack([np.linspace(-40, -40, 1000), np.linspace(-40, -65, 1000),
                           np.linspace(-65, -65, 1000), np.linspace(-65, -40, 1000)])

# BK "field outline" (from http://bicepkeck.org/B2_3yr_373sqdeg_field_20140509.txt)
b2_footprint  = np.loadtxt('B2_3yr_373sqdeg_field_20140509.txt', delimiter=',')
ra_b2_2014    = b2_footprint[:,0]
dec_b2_2014    = b2_footprint[:,1]
```

```python
visufunc.mollview(dust_map,
                  norm='log', coord='GC', notext=True, cbar=False, title='')
visufunc.graticule(20)

visufunc.projplot(ra_3g, dec_3g,
                  'C2', lonlat=True, label='SPT-3G')
visufunc.projplot(ra_sptpol, dec_sptpol,
                  'C1', lonlat=True, label='SPTpol')
visufunc.projplot(ra_sptsz, dec_sptsz,
                  'C3', lonlat=True, label='SPT-SZ')
visufunc.projplot(ra_b2_2014, dec_b2_2014,
                  'C4', lonlat=True, label='BICEP2')
plt.legend(fontsize=14)
```

```python
visufunc.orthview(dust_map, rot=(0, -55, 180),
                  norm='log', coord='GC', half_sky=True, notext=True, cbar=False, title='')
visufunc.graticule(15)

visufunc.projplot(ra_3g, dec_3g,
                  'C2', lonlat=True, label='SPT-3G')
visufunc.projplot(ra_sptpol, dec_sptpol,
                  'C1', lonlat=True, label='SPTpol')
visufunc.projplot(ra_sptsz, dec_sptsz,
                  'C3', lonlat=True, label='SPT-SZ')
visufunc.projplot(ra_b2_2014, dec_b2_2014,
                  'C4', lonlat=True, label='BICEP2')
plt.legend(fontsize=14)
```

```python

```
